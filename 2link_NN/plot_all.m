figure(1)
subplot(2,2,1)
x = 3:1:15;
y = [0.277, 0.223, 0.236, 0.226, 0.206, 0.194, 0.184, 0.25, 0.232, 0.219, 0.214, 0.231, 0.24];
plot(x,y);
xlim([3,15])
xlabel('Number of neighbours');
ylabel('MSE');
title('kNN for standardized control');

subplot(2,2,2)
x = 3:1:15;
y = [3.447, 2.801, 2.507, 2.874, 2.622, 2.474, 2.726, 3.382, 3.13, 3.007, 2.843, 2.881, 2.755];
plot(x,y);
xlim([3,15])
xlabel('Number of neighbours');
ylabel('MSE (\times 10^{-5})');
title('kNN for scaled control');

subplot(2,2,3)
x = 3:1:15;
y = [1.145, 1.063, 1.046, 1.017, 0.995, 0.985, 0.967, 0.966, 0.955, 0.944, 0.941, 0.939, 0.931];
plot(x,y);
xlim([3,15])
xlabel('Number of neighbours');
ylabel('MSE');
title('kNN for standardized cost');

subplot(2,2,4)
x = 3:1:15;
y = [388, 360, 352, 345, 344, 339, 338, 334, 327, 326, 324, 322, 321.8];
plot(x,y);
xlim([3,15])
xlabel('Number of neighbours');
ylabel('MSE (\times 10^{-4})');
title('kNN for scaled cost');

figure(2)
subplot(2,2,[1,2])
ykNN = [0.10903748, 0.04514475,  0.222036,    0.90781766,  0.94957097,  0.29541037,  0.16553654,  0.37901131,  0.35163455,  0.44909424,  0.17741171,  0.08001175,   0.355306,    0.44648773,  0.21355635,  0.58291597,  0.37641801,  0.56972563,   0.53959523,  0.41223902,  0.90659832,  0.92431766,  0.30617733,  0.03578419,0.05312895,  0.10166451,  0.77870554,  0.89485691,  0.93515995,  0.81427805,   0.78306109,  0.91339033,  0.6850041,   0.2268293,   0.08280779,  0.23974796, 0.16019508,  0.62058035,  0.88540894,  0.69909788]; 
yNN = [0.10918929,  0.0447973,   0.21818312,  0.91011423,  0.97560859,  0.29127651,   0.16398111,  0.37650242,  0.35060623,  0.44655061,  0.17873262,  0.08087588,   0.35174221,  0.44629088,  0.21112901,  0.57960749,  0.37390777,  0.56869465,   0.53909987,  0.41075659,  0.91461581,  0.93511212,  0.30516601,  0.,   0.05283412,  0.10096753,  0.77653646,  0.8858183,   0.95448887,  0.80616784,   0.78658128,  0.92058599,  0.68430889,  0.22826585,  0.08300564,  0.23692451,   0.15961194,  0.61448359,  0.88446265,  0.68196344];
actual = [0.10910422,  0.04488686,  0.21957537,  0.90412885,  0.94843105,  0.29448418,  0.16514286,  0.37901989,  0.35219223,  0.44981086,  0.17782199,  0.07982999,  0.35387662,  0.44893075,  0.21361781,  0.58083499,  0.37370432,  0.57235495,  0.54056116,  0.41223902,  0.90826739,  0.92474822,  0.30595343,  0.03534137,  0.05240802,  0.0998531,   0.77885673,  0.89446005,  0.93489745,  0.81380354,  0.78138566,  0.91136745,  0.68471512,  0.22808677,  0.08256257,  0.24102121,  0.15687191,  0.62340494,  0.88366312,  0.69909788];
hold on
plot(ykNN)
plot(yNN)
plot(actual)
hold off
xlabel('time (\times 0.025)')
ylabel('Scaled torque')
legend('kNN','NN','True')
title('Scaled kNN and NN predictions')

subplot(2,2,3)
ykNN = [-4.52880002e+01,  -1.76201279e+01,   4.90849137e+01,  -3.19300859e+01,    8.96893195e+00,   1.08961088e+02,   5.59021514e+01,   1.28851398e+01,    6.42791699e+00,   3.76925590e+01,  -1.37365448e+01,   6.71333657e+00,   -1.36937438e+02,  -1.61802961e+02,   3.27540313e+01,  -6.12998745e+01,   -2.22115734e+01,  -4.47385749e+01,   7.68299238e+01,  -2.44550320e-05,   -3.16202538e+01,  -4.13605503e+01,   1.44419777e+01,   6.70050261e+00,    1.68007588e+01,   1.19940696e+01,  -7.05018204e+01,   1.10619385e+01,   -2.11534212e+01,  -9.67603779e+00,   3.31575431e+01,   1.80833507e+01,   -3.75132206e+01,  -8.15587958e+01,  -2.81529026e+01,   2.26423842e+01,   -8.48808565e+00,   4.67834608e+01,   7.90615975e+01,   7.30786996e-06];
yNN = [-2.14826378e+01,  -5.90450342e+01,  -1.69491981e+02,   2.02567579e+01,    1.13687828e+03,  -4.18590235e+02,  -1.72455914e+02,  -2.12453165e+02,   -8.38771539e+01,  -1.45627933e+02,   8.24657208e+01,   6.29458183e+01,   -4.51772740e+02,  -1.72725867e+02,  -1.04374143e+02,  -3.34022490e+02,   -3.17279468e+02,  -1.51140119e+02,   2.17120853e+01,  -1.74396199e+02,    3.44028266e+02,   6.52627583e+02,  -1.21904322e+02,  -3.22755751e+03,    2.52236287e+00,  -1.91653625e+01,  -3.75437958e+02,  -1.09723644e+03,    2.53903502e+03,  -5.97681328e+02,   2.72793133e+02,   4.48604802e+02,   -7.61201026e+01,   9.61169081e+00,  -1.62741107e+01,  -4.12186649e+01,   -2.81142086e+01,  -5.05838079e+02,   7.67494560e+00,  -1.52435160e+03];
actual = [-3.48216037e+01,  -4.83673515e+01,  -9.05080900e+01,  -1.15754014e+02,  -4.04105939e+01,  -9.23622757e+00,  -1.89605695e+00,   1.36551310e+01,   5.54021080e+01,   8.93396215e+01,   1.61441154e+01,  -5.11503131e+00,  -2.63212942e+02,  -2.62444602e+01,   3.62257614e+01,  -2.32837555e+02,  -3.41194699e+02,   2.26619703e+02,   1.84306563e+02,  -1.01215846e-07,   4.65816158e+01,  -1.36790253e+01,  -1.57448087e+01,  -3.33222854e+01,  -1.81130330e+01,  -6.89876366e+01,  -4.92474547e+01,  -3.76000103e+01,  -5.59232466e+01,  -4.40790733e+01,  -8.08968317e+01,  -1.02946775e+02,  -5.35606115e+01,  -1.75348302e+00,  -4.28762538e+01,   5.14408826e+01,  -1.20332456e+02,   3.02809224e+02,  -5.26413216e+01,  -1.82015356e-07];
hold on
plot(ykNN)
plot(actual)
hold off
xlabel('time (\times 0.025)')
ylabel('Actual torque')
legend('kNN','True')
title('True kNN prediction')

subplot(2,2,4)
hold on
plot(yNN)
plot(actual)
hold off
xlabel('time (\times 0.025)')
ylabel('Actual torque')
legend('NN','True')
title('True NN prediction')